# WORK NOW 要件定義

## 目的
- 即戦力人材と企業をリアルタイムにマッチングするプラットフォーム。
- ワーカーは案件に応募し、採用後は Stripe Connect を通じて報酬を受け取る。
- 企業は案件の投稿、応募管理、割当、支払いを一元管理できる。
- 管理者は全体の運用状況、違反管理、サポートを行う。

## ユーザーロール
- **ワーカー**: プロフィール編集、案件閲覧・応募、割当確認、勤怠報告、報酬確認、通知受信。
- **企業**: 求人掲載、応募審査、ワーカー割当、勤怠承認、支払い、レビュー作成、通知受信。
- **管理者**: ユーザー/案件の審査、収益確認、KPI監視、サポート対応、コンテンツ管理。

## コア機能
1. **認証/認可**
   - メール+パスワード、OAuth（Supabase Auth）によるログイン。
   - JWT アクセストークンとリフレッシュトークン。
   - 役割に応じた RBAC。

2. **プロフィール管理**
   - 基本情報、職歴/スキル、本人確認書類アップロード（Firebase Storage）。
   - 企業の会社情報、担当者情報、証明書類。

3. **求人管理**
   - 求人作成/編集/公開停止。
   - 仕事内容、報酬、勤務地、勤務時間、必要スキル、タグ。
   - 検索・フィルタリング、ソート。

4. **応募・割当**
   - ワーカーの応募、企業のステータス管理（審査中/採用/辞退）。
   - 採用後の割当レコード作成。
   - 勤怠・納品記録、コメント。

5. **決済（Stripe Connect）**
   - ワーカー Stripe アカウント作成/接続。
   - 企業からの支払いフロー（Payment Intent）。
   - プラットフォーム手数料設定、トランザクション履歴。
   - Webhook で支払いステータス同期。

6. **レビュー/評価**
   - ワーカー⇔企業の相互レビュー。
   - 星評価、コメント、公開ステータス管理。

7. **通知/メッセージング**
   - 重要イベント（応募、採用、支払い）を Firebase Cloud Messaging で Push。
   - アプリ内通知リスト、既読管理。

8. **管理者ダッシュボード**
   - KPI（登録者数、案件数、売上）。
   - 利用状況モニタリング（リアルタイムリスト）。
   - ユーザー・案件の凍結/再開。

9. **運用・セキュリティ**
   - 監査ログ、エラートラッキング、二段階認証（将来対応）、
     レートリミット（Redis）、バックアップポリシー。

## 外部サービス
- Supabase: Auth、Postgres、Storage。
- Stripe Connect: 支払い管理。
- Firebase: Push 通知、ドキュメント保存。
- Redis: セッション・レート制限。

## 非機能要件
- FastAPI + PostgreSQL（Supabase）ベースで API を提供。
- Flutter アプリを iOS/Android/Web 対応で提供。
- デプロイ: Hostinger VPS (Ubuntu)、systemd + nginx + certbot。
- 可用性: 監視（UptimeRobot 推奨）、ログ収集（Cloud Logging 連携検討）。
- セキュリティ: HTTPS 必須、JWT と Stripe シークレットの安全管理。

## ロードマップ（大項目）
1. 認証/ユーザー基盤
2. 求人・応募データモデル実装
3. Stripe 決済フロー構築
4. 通知/レビュー実装
5. Flutter UI 各画面 & API 連携
6. デプロイ・モニタリング整備
